\documentclass[14pt, a4paper]{article}
\usepackage{minitoc}
\usepackage[left=3.00cm, right=2.5cm, top=2.00cm, bottom=2.00cm]{geometry}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{mathtools}
\usepackage{graphicx}
%\usepackage{algpseudocode}
%\usepackage{algorithm}
\usepackage[ruled,vlined,linesnumbered]{algorithm2e}
\usepackage{blindtext}
\usepackage{setspace}
\usepackage[utf8]{inputenc}
\usepackage[utf8]{vietnam}
\usepackage[center]{caption}
\usepackage[shortlabels]{enumitem}
\usepackage{fancyhdr} % header, footer
\usepackage{hyperref} % loại bỏ border với mục lục và công thức
\usepackage[nonumberlist, nopostdot, nogroupskip]{glossaries}
\usepackage{glossary-superragged}
\usepackage{tikz,tkz-tab}
\usepackage{pythonhighlight}
\setglossarystyle{superraggedheaderborder}
\pagestyle{fancy}
%\usepackage[style=numeric,sortcites]{biblatex}
%\addbibresource{ref.bib}
%\usepackage[numbers]{natbib}
\usepackage{indentfirst}
\usepackage[natbib,backend=biber,style=ieee, sorting=ynt]{biblatex}

\usepackage{caption}
\usepackage{subcaption}

\bibliography{ref.bib}

\graphicspath{{./figures/}}

\fancyhf{}
%\rhead{\textbf{Môn học: Các phương pháp thống kê hiện đại trong nghiên cứu Xã hội học}}
\lhead{\textbf{GVHD: TS. Trịnh Quốc Anh}}
\rfoot{\thepage}
\lfoot{\textbf{Học viên thực hiện: Nguyễn Chí Thanh - 21007925}}
\renewcommand{\headrulewidth}{0.4pt}
\renewcommand{\footrulewidth}{0.4pt}
%
%\numberwithin{equation}{section}
%\numberwithin{algorithm}{section}
%\numberwithin{figure}{section}
%
%\setlength{\parindent}{0.5cm}
%
%\setcounter{secnumdepth}{3} % Cho phép subsubsection trong report
%\setcounter{tocdepth}{3} % Chèn subsubsection vào bảng mục lục

%\newtheorem{dl}{Định lý}
%\newtheorem{md}{Mệnh đề}
%\newtheorem{bd}{Bổ đề}
%\newtheorem{dn}{Định nghĩa}
%\newtheorem{hq}{Hệ quả}

%\newtheorem{baitap}{Bài tập}
%\newtheorem*{loigiai}{Lời giải}

%\numberwithin{dl}{section}
%\numberwithin{md}{section}
%\numberwithin{bd}{section}
%\numberwithin{dn}{section}
%\numberwithin{hq}{section}

\setlength{\parindent}{0cm}

\newtheorem{dl}{Định lý}
\newtheoremstyle{sltheorem}
{}                % Space above
{}                % Space below
{\normalfont}        % Theorem body font % (default is "\upshape")
{}                % Indent amount
{\bfseries}       % Theorem head font % (default is \mdseries)
{.}               % Punctuation after theorem head % default: no punctuation
{ }               % Space after theorem head
{}                % Theorem head spec
\theoremstyle{sltheorem}
\newtheorem{baitap}{Bài tập}
\newtheoremstyle{soltheorem}
{}                % Space above
{}                % Space below
{\normalfont}        % Theorem body font % (default is "\upshape")
{}                % Indent amount
{\bfseries}       % Theorem head font % (default is \mdseries)
{.}               % Punctuation after theorem head % default: no punctuation
{\newline}               % Space after theorem head
{}                % Theorem head spec
\theoremstyle{soltheorem}
\newtheorem*{loigiai}{Lời giải}

\onehalfspacing

\begin{document}
\begin{titlepage}

    \newcommand{\HRule}{\rule{\linewidth}{0.5mm}} % Defines a new command for the horizontal lines, change thickness here

    \center % Center everything on the page

    %----------------------------------------------------------------------------------------
    %	HEADING SECTIONS
    %----------------------------------------------------------------------------------------
    \textsc{\LARGE Đại học Quốc Gia Hà Nội}\\[0.5cm]
    \textsc{\LARGE Trường đại học Khoa học tự nhiên}\\[0.5cm] % Name of your university/college
    \textsc{\LARGE Khoa Toán - Cơ - Tin học}\\[0.5cm]

    \includegraphics[scale=0.2]{HUS-logo.jpg}\\[0.5cm]

    \textsc{\Large Chuyên ngành: Khoa học dữ liệu}\\[0.5cm] % Major heading such as course name


    %----------------------------------------------------------------------------------------
    %	TITLE SECTION
    %----------------------------------------------------------------------------------------

    \HRule \\[0.4cm]
    { \huge \bfseries Bài tập môn học}\\[0.4cm] % Title of your document
    \HRule \\[1.5cm]

    \textsc{\Large Môn học: Các phương pháp thống kê hiện đại \\ trong nghiên cứu Xã hội học}\\[1cm] % Minor heading such as course title


    \textsc{\Large Bài tập số 4}\\[1cm]


    %----------------------------------------------------------------------------------------
    %	AUTHOR SECTION
    %----------------------------------------------------------------------------------------
    \begin{minipage}{0.4\textwidth}
        \begin{flushleft} \large
        \emph{Giảng viên hướng dẫn:} \\
        TS. Trịnh Quốc Anh % Supervisor's Name
        \end{flushleft}
    \end{minipage}\\[0.5cm]

    \begin{minipage}{0.4\textwidth}
    \begin{flushleft} \large
    \emph{Học viên thực hiện:}\\
    Nguyễn Chí Thanh \\
    MSHV: 21007925 \\ % Your name
    Lớp: Khoa học dữ liệu - K4
    \end{flushleft}
    \end{minipage}


    % If you don't want a supervisor, uncomment the two lines below and remove the section above
    %\Large \emph{Author:}\\
    %John \textsc{Smith}\\[3cm] % Your name

    %----------------------------------------------------------------------------------------
    %	DATE SECTION
    %----------------------------------------------------------------------------------------

    % I don't want day because it is English
    % {\large \today}\\[2cm] % Date, change the \today to a set date if you want to be precise

    %----------------------------------------------------------------------------------------
    %	LOGO SECTION
    %----------------------------------------------------------------------------------------

    %\includegraphics{logo/rsz_3logo-khtn.png}\\[1cm] % Include a department/university logo - this will require the graphicx package

    %----------------------------------------------------------------------------------------

    \vfill % Fill the rest of the page with whitespace

\end{titlepage}

\nocite{*}

\newpage

\begin{baitap}
    Hãy tóm tắt về nghiên cứu "Who plays video games?":
    \begin{itemize}
        \item Vấn đề/câu hỏi cần nghiên cứu
        \item Dữ liệu dùng để nghiên cứu
        \item Cơ sở và phương pháp nghiên cứu
    \end{itemize}
\end{baitap}

\begin{loigiai}
    Hãy tóm tắt về nghiên cứu "Who plays video games?":
    \begin{itemize}
        \item Vấn đề/câu hỏi cần nghiên cứu:
        \begin{enumerate}
            \item Bắt đầu bằng cách đưa ra tỷ lệ sinh viên chơi game trong tuần trước khi cuộc khỏa sát diễn ra.
            Ước lượng khoảng tin cậy cũng như ước lượng điểm cho tỷ lệ này.
            \item Xét thời gian chơi gam trong tuần trước khi cuộc khảo sát diễn ra so với tần suất chơi ghi nhận được (hàng ngày, hàng tuần,...).
            Liệu nếu có một bài kiểm tra vào tuần trước khi diễn ra cuộc khảo sát có làm ảnh hưởng đến ước lượng ở câu hỏi trước?
            \item Tìm khoảng tin cậy cho thời gian chơi game trung bình của một sinh viên trước cuộc khảo sát.
            Ta cần chú ý đến phân phối mẫu.
            \item Ta xét về các câu hỏi mang tính "thái độ".
            Nhìn chung sinh viên có thích chơi gam hay không?
            Nếu ta phải lập một danh sách ngắn các lý do quan trọng vì sao sinh viên thích (hoặc không thích) chơi game, ta sẽ đưa gì vào danh sách?
            \item Tìm sự khác biệt giữa những sinh viên chơi game và những sinh viên không chơi game.
            Để làm được điều này, hãy sử dụng những câu hỏi trong phần cuối của cuộc khỏa sát và so sánh giữa sinh viên nam và sinh viên nữ,
            những người có đi hay làm hay không, có máy tính hay không hoặc những người đặt kỳ vọng được điểm A trong các môn học hay không.
            Một số phương pháp trực quan hữu ích trong so sánh các tiêu chí trên.
            \item Ta sẽ nghiên cứu sau hơn về điểm số mà các sinh viên mong muốn trong các môn học.
            Kết quả cuộc khảo sát với phù hợp với phân phối điểm là 20\% điểm A, 30 \% điểm B, 40 \% điểm C, 10 \% điểm D hoặc thấp hơn.
            Nếu những sinh viên không trả lời là những sinh viên bị trượt thì bức tranh toàn cảnh của cuộc khảo sát sẽ thay đổi thế nào?
        \end{enumerate}

        \item Dữ liệu dùng để nghiên cứu:
        
        95 trong tổng số 314 sinh viên tham gia khóa học Thống kê 2 vào mùa đông 1994 được chọn ngẫu nhiên tham gia vào cuộc khảo sát.
        Các câu hỏi đã được hoàn thành thu được từ 91 trong tổng số 95 sinh viên.
        Dữ liệu có được là các phản hồi của sinh viên đối với bảng câu hỏi.

        Cuộc khảo sát yêu cầu sinh viên xác định tần suất chơi game và điều gì làm sinh viên thích và không thích về các tựa game.
        Câu trả lời cho những câu hỏi này đã được mã hóa bằng số như được mô tả trong Bảng 2.1.
        Bảng 2.1 cũng cung cấp một vài mẫu quan sát. Nếu một câu hỏi không được trả lời hoặc trả lời không chính xác, thì nó được mã hóa thành 99. Tất cả các câu hỏi có câu trả lời có/không đều được ghi 1 cho "Có" và 0 cho "Không".
        Những người trả lời chưa bao giờ chơi game hoặc hoàn toàn không thích chơi game được yêu cầu bỏ qua nhiều câu hỏi.

        Cuộc khảo sát có thể tạm chia thành ba phần. Hai trong số ba phần liên quan đến việc chơi gam của sinh viên.
        Một trong những phần này xác định tần suất chơi game của sinh viên.
        Thông tin này được yêu cầu qua hai câu hỏi.
        Một câu hỏi hỏi sinh viên dành bao nhiêu thời gian chơi game vào tuần tước khi diễn ra khảo sát và câu hỏi còn lại hỏi tần suất chơi game của sinh viên (hàng ngày, hàng tuần, hàng tháng, học kỳ).

        Phân thứ hai của cuộc khảo sát bao gồm việc sinh viên có thích chơi game hay không và vì sao.
        Một bản tổng hợp các phản hồi cho ba trong số những câu hỏi này xuất hiện trong bảng 2.2,  2.3 và 2.4.
        Những câu hỏi này khác với những câu hỏi khác ở chỗ có thể đưa ra nhiều hơn một câu trả lời.
        Bảng 2.2 tóm tắc các thể loại game đã được sinh viên chơi.
        Sinh viên được yêu cầu đánh dấu vào tất cả các thể loại game mà sinh viên đã chơi.
        Ví dụ, 50 \% sinh viên trả lời câu hỏi này nói rằng họ có chơi game thuộc thể loại hành động.
        Không phải tất cả các sinh viên đều trả lời câu hỏi này, vì mootjsoos sinh viên nói rằng họ chưa từng chơi game hoặc không hề thích chơi game sẽ được hướng dẫn bỏ qua các câu hỏi này.
        Những sinh viên đã trả lời câu hỏi này cũng được hỏi lý do vì sao họ chơi các game đó.
        Họ được yêu cầu chọn ba lý do. Phản hồi của các sinh viên được trình bày trong bảng 2.3,
        Cuối cùng, bảng 2.4 tóm tắt những điều mà sinh viên không thích về các tựa game đó.
        Tất cả các sinh viên được yêu cầu trả lời câu hỏi này và được chọn tối đa ba lý do không thích chơi game.

        Phần thứ ba của bảng câu hỏi là thu thập các thông tin cá nhân chung về sinh viên như là tuổi, giới tính.
        Các sinh viên cũng được hỏi họ có tài khoản email hay không, họ có thích hay ghét môn toán không, điểm số các môn học mà họ kỳ vọng.

        Ta có tổng 314 sinh viên. Để chọn ra 95 sinh viên cho nghiên cứu, mỗi sinh viên được đánh số từ 1 đến 314.
        Một bộ sinh số ngẫu nhiên chọn 95 số giữa 1 và 314.
        Các sinh viên tương ứng được chọn vào nghiên cứu.

        Để khuyến kích trả lời trung thực, thì thông tin của sinh viên sẽ được giữa bí mật.
        Mọi phiếu trả lời không được điền tên.

        Để hạn chế số phiếu không phản hồi, hệ thống thu thập dữ liệu gồm ba bước được triển khai.
        Người thu thập dữ liệu sẽ đến vào thứ ba và thứ năm nói về cuộc khảo sát sẽ được thực hiện.
        Sinh viên đã làm bài kiểm tra trước cuộc khảo sát và được trả kết quả trong tuần thực hiện khảo sát.
        
        Cuối cùng, để tăng độ chính xác của cuộc khảo sát, người thu thập dữ liệu sẽ phải khuyến khích sinh viên và cho biết sự đảm bảo về thông tin cá nhân.

        Các game được phân loại theo các thiết bị mà game được chạy và loại kỹ năng cần để chơi game.
        Với thiết bị, được chia thành ba loại cơ bản: arcade, console và máy tính cá nhân.
        Với thể loại, game được chia thành năm thể loại: hành động, phiêu lưu, mô phỏng, chiến thuật và nhập vai.

        Đa số các arcade game là các game thuộc thể loại game hành động mà yêu cầu sự linh hoạt của tay và mắt và không cần thời gian học lâu.
        Game chạy trên console có thể là hành động, phiêu lưu hoặc chiến thuật.
        Các game mô phỏng hoặc nhập vai hay được chơi trên máy tính cá nhâ.
        Các game này không phù hợp trên arcade hoặc console vì cần nhiều giờ chơi.
        Các thể loại game đều có thể chơi trên PC.

        \item Cơ sở và phương pháp nghiên cứu:
        Ta sẽ sử dụng phương pháp học không giám sát là phân cụm.
        Nhưng nếu để nguyên dữ liệu, các điểm dữ liệu có số chiều rất lớn.
        Để việc phân tích hiệu quả, ta sẽ giảm chiều dữ liệu và phân cụm các điểm dữ liệu trên không gian đã được giảm chiều.
        Ta sẽ gán các cụm là các nhãn giả với từng mẫu dữ liệu.
        Ta thực hiện huấn luyện một mô hình phân loại trên dữ liệu đã được giảm chiều dùng PCA và nhãn tương ứng với các cụm.
        Sau khi có được mô hình phân loại ta sẽ biển đổi các trọng số được huấn luyện từ không gian giảm chiều trở lại không gian các đặc trưng gốc từ đó ta xác định những yếu tố ảnh hưởng nhiều đến việc phân loại sinh viên theo khả năng chơi game.
        Ta có mã giả thực hiện PCA:

        \begin{algorithm}[h!]
            \DontPrintSemicolon
            \KwIn{Dữ liệu $\mathcal{D} \in \mathbb{R}^{N \times d}$, tỷ lệ thông tin giữ lại $\alpha$}

            $\bold{\mu} \gets \dfrac{1}{N} \sum_{i=1}^N \bold{x}_i$\;
            $\bold{Z} \gets \mathcal{D} - \bold{\mu}^T$\;
            $\bold{\Sigma} \gets \dfrac{1}{N}\bold{Z}^T \bold{Z}$\;
            Tính các trị riêng $\lambda_1, \lambda_2, \dots, \lambda_d$ và các vector riêng tương ứng $\bold{e}_1, \bold{e}_2, \dots, \bold{e}_d$\;
            $f(r) \gets \dfrac{\sum_{i=1}^r \lambda_i}{\sum_{j=1}^d \lambda_j}$\;
            Tìm $r$ nhỏ nhất sao cho $f(r) \geq \alpha$\;
            $\bold{U} \gets \begin{bmatrix} \bold{e}_1  & \bold{e}_2  & \dots  & \bold{e}_r \end{bmatrix}$\;
            $\mathcal{D}_r \gets \mathcal{D} \times \bold{U}$\;
            \Return{$\mathcal{D}_r$}\;
            \caption{Thuật toán thực hiện PCA}
            \label{alg:PCA}
        \end{algorithm}

        Với:

        \begin{equation*}
            \mathcal{D} = \begin{bmatrix}
                \bold{x}_1^T \\ \bold{x}_2 \\ \vdots \\ \bold{x}_N^T
            \end{bmatrix} \in \mathbb{R}^{N \times d}
        \end{equation*}
        và:

        \begin{equation*}
            \bold{U} = \begin{bmatrix}
                \bold{e}_1 & \bold{e}_2 & \dots & \bold{e}_r
            \end{bmatrix} \in \mathbb{R}^{d \times r}
        \end{equation*}

        Khi ta tìm được các trọng số được huấn luyện của mô hình phân loại là $\bold{W}_{PCA} \in \mathbb{R}^{\mathrm{c} \times r}$ ($c$ là số lớp).
        Ta tìm các trọng số trong không gian dữ liệu ban đầu là $\bold{W} \in \mathbb{R}^{\mathrm{c} \times d}$ bằng công thức $\bold{W} =   \bold{W}_{PCA} \times \bold{U}^T$.
    \end{itemize}
\end{loigiai}


\begin{baitap}
    Hãy đề xuất mô hình phân loại sinh viên và khả năng chơi games
\end{baitap}

\begin{loigiai}
    Ta sẽ thực hiện thống kê mô tả tập dữ liệu.
    Dataframe thứ nhất gồm 15 trường:

    \begin{itemize}
        \item time là thời gian chơi game (số tiếng) của sinh viên trong một tuần trước khi cuộc khảo sát diễn ra.
        \item like thể hiện mức độ thích chơi game của sinh viên.
        \item where thể hiện sinh viên thường xuyên chơi game trên hệ máy nào.
        \item freq thể hiện tần suất chơi game của sinh viên.
        \item busy thể hiện sinh viên có chơi game lúc rảnh hay không.
        \item educ quan điểm của sinh viên là game có mang tính giáo dục hay không.
        \item sex là giới tính của sinh viên.
        \item age là tuổi của sinh viên.
        \item home thể hiện sinh viên có hay chơi game ở nhà không
        \item math thể hiện sinh viên có ghét toán hay không
        \item work thể hiện thời gian làm thêm của sinh viên trong tuần trước khi cuộc khảo sát diễn ra.
        \item own thể hiện sinh viên có máy tính cá nhân hay không
        \item cdrom thể hiện máy tính của sinh viên có ổ đĩa CD-ROM hay không
        \item email thể hiện sinh viên có tài khoản email hay không
        \item grade là điểm kỳ vọng của sinh viên trong các môn học
    \end{itemize}

    Có một số trường tương ứng với một số điểm dữ liệu là 99 do sinh viên không trả lời hoặc trả lời sai định sạng ta sẽ đặt thành -1.

    Dataframe thứ hai gồm 21 trường:

    \begin{itemize}
        \item action thể hiện sinh viên có chơi game thể loại hành động hay không
        \item adv thể hiện sinh viên có chơi game thể loại phiêu lưu hay không
        \item sim thể hiện sinh viên có chơi game thuộc thể lại mô phỏng không
        \item sport thể hiện sinh viên có chơi game thuộc thể loại thể thao không
        \item strategy thể hiện sinh viên có chơi game thuộc thể loại chiến thuật không
        \item relax thể hiện sinh viên có chơi game để thư giãn không
        \item coord thể hiện sinh viên có chơi game để cải thiện sự nhanh tay/mắt không
        \item challenge thể hiện sinh viên có chơi game để thử thách bản thân hay không
        \item master thể hiện sinh viên có chơi game để cảm thấy vui vẻ khi kết thúc một tựa game không
        \item bored thể hiện sinh viên chơi game để tránh những thời gian cảm thấy buồn, nhàm chán.
        \item other thể hiện lý do khác vì sao sinh viên chơi game
        \item graphic thể hiện sinh viên có chơi game vì đồ họa hay tính chân thực của game không
        \item time thể hiện sinh viên không thích chơi game có vì tốn thời gian hay không
        \item frust thể hiện sinh viên không thích chơi game vì thất vọng vì tựa game họ chơi hay không
        \item lonely thể hiện sinh viên không thích chơi game vì rất cô đơn khi chơi game
        \item rules thể hiện sinh viên không thích chơi game vì có quá nhiều quy tắc trong game phải Học
        \item cost thể hiện sinh viên không thích chơi game vì tốn kém chi phí
        \item boring thể hiện sinh viên không thích chơi game vì tựa game nhàm chán
        \item friends thể hiện sinh viên không thích chơi game vì bạn của họ không chơi game.
        \item point thể hiện sinh viên không thích chơi game vì vô nghĩa, không có mục đích.
        \item other2 thể hiện sinh viên không thích chơi game vì lý do khác.
    \end{itemize}

    Do 2 trường other và other2 có thuộc dạng xâu ký tự nhưng trường này rất thưa nên ta sẽ loại bỏ hai trường này.
    Có 4 điểm dữ liệu liên tiếp mà mọi trường tương ứng đều có giá trị là "NA" ta sẽ chuyển các giá trị thành -1.

    Ta ghép hai dataframe trên lại thành một dataframe có 34 trường.
    Các trường đều có dạng biến phân loại.
    Có 2 trường là time.
    Một trường time từ dataframe thứ nhất thể hiện số giờ chơi game của sinh viên trong tuần trước khi cuộc khảo sát diễn ra.
    Một trường time đến từ dataframe thứ hai thể hiện sinh viên không thích chơi game vì tốn thời gian hay không.
    Để tránh nhầm lẫn ta sẽ đặt lại tên trường time từ dataframe thứ nhất là time\_1 và trường time đến từ dataframe thứ hai là time\_2.
    Ta sẽ vẽ biểu đồ cột thể hiện tần suất của từng giá trị tương ứng với từng trường
    \begin{figure}[h!]
        \centering
        \includegraphics[width=0.6\textwidth]{1.png}
        \caption{Biểu đồ tần suất của các trường like, where, freq, busy, educ, sex}
        \label{fig:1}
    \end{figure}

    \begin{figure}[h!]
        \centering
        \includegraphics[width=0.6\textwidth]{2.png}
        \caption{Biểu đồ tần suất của các trường home, math, own, cdrom, email, grade}
        \label{fig:2}
    \end{figure}

    \begin{figure}[h!]
        \centering
        \includegraphics[width=0.6\textwidth]{3.png}
        \caption{Biểu đồ tần suất của các trường age, work}
        \label{fig:3}
    \end{figure}

    \begin{figure}[h!]
        \centering
        \includegraphics[width=0.6\textwidth]{4.png}
        \caption{Biểu đồ tần suất của các trường action, adv, sim, sport, strategy, relax}
        \label{fig:4}
    \end{figure}

    \begin{figure}[h!]
        \centering
        \includegraphics[width=0.6\textwidth]{5.png}
        \caption{Biểu đồ tần suất của các trường challenge, master, bored, graphic, time\_2, frust}
        \label{fig:5}
    \end{figure}

    \begin{figure}[h!]
        \centering
        \includegraphics[width=0.6\textwidth]{6.png}
        \caption{Biểu đồ tần suất của các trường rules, cost, boring, friends, points}
        \label{fig:6}
    \end{figure}

    \begin{figure}[h!]
        \centering
        \includegraphics[width=0.6\textwidth]{7.png}
        \caption{Histogram của trường time\_1}
        \label{fig:7}
    \end{figure}

    Các hình \ref{fig:1}, hình \ref{fig:2}, \ref{fig:3}, \ref{fig:4}, \ref{fig:5}, \ref{fig:6} thể hiện biểu đồ tần suất của các trường.
    Đa số các sinh viên thích game ở mức độ vừa phải.
    Đa số các sinh viên nếu chơi game thì chơi trên máy tính tại nhà.
    Đa số các sinh viên nếu chơi game sẽ chơi game với tần suất hàng tuần hoặc theo học kỳ.
    Đa số các sinh viên sẽ không chơi game nếu bận.
    Số ít hơn các sinh viên có chơi game mang tính giáo dục.
    Đa số các sinh viên tham gia khảo sát là sinh viên nam.

    Đa số các sinh viên không ghét môn toán.
    Đa số các sinh viên sở hữu máy tính cá nhân.
    Chỉ một số ít máy tính của các sinh viên có ổ đĩa CD-ROM.
    Đa số các sinh viên có địa chỉ email.
    Đa số các sinh viên có kỳ vọng đạt điểm B trong các môn học.

    Đa số các sinh viên nằm trong độ tuổi từ 18 đến 20 tuổi.
    Đa số các sinh viên không làm thêm vào tuần ngay trước khi diễn ra cuộc khảo sát.

    Trong các thể loại game, thể loại hành động và chiến thuật được nhiều sinh viên chơi nhất.
    Khá ít các sinh viên chơi các thể loại game mô phỏng và phiêu lưu.
    Đa số các sinh viên chơi game vì mục đích thư giãn, xả stress.
    Số ít các sinh viên chơi game để thử thách bản thân hay vì thích đồ họa của game.

    Đa số các sinh viên không thích chơi game vì tốn thời gian và chi phí đắt hoặc vô ích.
    Số ít viên không thích chơi game vì lý do game nhiều luật chơi phức tạp hay nhàm chán, bạn của họ không tham gia chơi.

    Thời gian chơi game trong tuần ngay trước khi diễn ra cuộc khảo sát diễn ra đa số các sinh viên chơi game ít hơn 5 tiếng, có cá biệt một số sinh viên chơi game 30 tiếng/tuần.

    Để thực hiện phân cụm các sinh viên, ta sẽ sử dụng PCA ở thuật toán \ref{alg:PCA}
    Trước khi đưa vào thuật toán, ta sẽ sử dụng minmax-scaling dữ liệu.
    Ta chọn số chiều sau khi thực hiện PCA bằng cách giữ lại 95 \% thông tin của dữ liệu ban đầu.
    Ta thực hiện PCA bằng đoạn code:

    \begin{python}
data_encoded = pd.get_dummies(total_df)
scaler = MinMaxScaler()
data_scaled = scaler.fit_transform(data_encoded)
pca = PCA()
pca.fit(data_scaled)

cumulative_var = pca.explained_variance_ratio_.cumsum()
n_components = np.where(cumulative_var > 0.95)[0][0]
pca = PCA(n_components=n_components)
pca.fit(data_scaled)
reduced_data = pca.transform(data_scaled)
    \end{python}

    Ta vẽ biểu đồ scatter-plot giữa đôi một trong số 4 chiều đầu tiên của dữ liệu sau khi qua thuật toán PCA bằng đoạn code:

    \begin{python}
def scatter_plot_pca(x: np.ndarray, y: np.ndarray=None):
    fig = plt.figure(figsize=(15, 15), facecolor='w')
    fig.subplots_adjust(left=None, bottom=None, right=None, top=None, wspace=0.2, hspace=0.2)
    nums = len(list(combinations(range(x[:,:4].shape[1]), r=2)))
    cols = 3
    rows = math.ceil(nums/cols)
    i = 0
    
#fig, ax = plt.subplots(rows, cols)
for couple in combinations(range(x[:,:4].shape[1]), r=2):
    ax = fig.add_subplot(rows, cols, i + 1)
    ax.set_title("Axis {} - Axis {}".format(couple[0], couple[1]))
    x_ax = x[:, couple[0]]
    y_ax = x[:, couple[1]]
    if y is not None:
        for g in np.unique(y):
            ix = np.where(y == g)
            ax.scatter(x_ax[ix], y_ax[ix], label=g, s=50)
    else:
        ax.scatter(x_ax, y_ax, s=50)

    ax.set_xlabel("Axis {}".format(couple[0]))
    ax.set_ylabel("Axis {}".format(couple[1]))
    ax.set_aspect(abs((x_ax.max() - x_ax.min())/(y_ax.max() - y_ax.min()))*1.0)
    ax.grid()
    ax.legend()
    i += 1

scatter_plot_pca(x=reduced_data)
    \end{python}


    \begin{figure}[h!]
        \centering
        \includegraphics[width=0.75\textwidth]{figures/pca_scattering_4_dim.png}
        \caption{Scatter plot của các chiều thứ 0 đến chiều thứ 3 của dữ liệu sau khi được giảm chiều qua PCA}
        \label{fig:pca-scattering-4-dim}
    \end{figure}

    Biểu đồ scatter-plot giữa đôi một trong số 4 chiều đầu tiên của dữ liệu sau khi qua thuật toán PCA được thể hiện ở hình \ref{fig:pca-scattering-4-dim}

    \begin{figure}[h!]
        \centering
        \includegraphics[width=0.6\textwidth]{figures/dendro_ward.png}
        \caption{Dendrogram được sử dụng dựa trên Ward linkage}
        \label{fig:dendro-ward}
    \end{figure}

    \begin{figure}[h!]
        \centering
        \includegraphics[width=0.6\textwidth]{figures/dendro_single.png}
        \caption{Dendrogram được sử dụng dựa trên Single linkage}
        \label{fig:dendro-single}
    \end{figure}

    \begin{figure}[h!]
        \centering
        \includegraphics[width=0.6\textwidth]{figures/dendro_complete.png}
        \caption{Dendrogram được sử dụng dựa trên Complete linkage}
        \label{fig:dendro-complete}
    \end{figure}

    \begin{figure}[h!]
        \centering
        \includegraphics[width=0.6\textwidth]{figures/dendro_average.png}
        \caption{Dendrogram được sử dụng dựa trên Average linkage}
        \label{fig:dendro-average}
    \end{figure}

    Tiếp đến ta sẽ thực hiện vẽ các Dendrogram theo các linkage (cách tính khoảng cách giữa các nhóm điểm).
    Kết quả được thể hiện ở cách hình \ref{fig:dendro-ward}, \ref{fig:dendro-single}, \ref{fig:dendro-complete}, \ref{fig:dendro-average}.
    Ở các hình ta đều thấy có một nhóm 4 điểm chính là điểm dữ liệu 52,53,54,55 vì các điểm này các trường bên phía dữ liệu.
    Các linkage single và average cho thấy không có sự tách biệt lớn giữa các điểm dữ liệu trừ các điểm dữ liệu 52,53,54,55.
    Các linkage ward và complete cho thấy sự tách biệt giữa các nhóm điểm dữ liệu tốt hơn.
    
    Ta sử dụng phương pháp phân cụm AgglomerativeClustering (phân cụm kết tụ - bottom up).
    Phương pháp phân cụm này rất tương tự cách tạo Dendrogram khi tạo các cụm từ các điểm gần nhau nhất theo khoảng cách.
    Ta chọn ngưỡng từ Dendrogram sử dụng complete linkage là 2.8.
    Kết quả của quá trình phân cụm sẽ trở thành nhãn giả của các điểm dữ liệu:
    Ta sử dụng đoạn code:

    \begin{python}
clustering = AgglomerativeClustering(n_clusters=None, linkage="complete", distance_threshold=2.8, compute_distances=True).fit(reduced_data)
y = clustering.labels_
    \end{python}

    \begin{figure}[h!]
        \centering
        \includegraphics[width=0.75\textwidth]{figures/pca_scattering_4_dim_clustering.png}
        \caption{Scatter plot của các chiều thứ 0 đến chiều thứ 3 của dữ liệu sau khi được giảm chiều qua PCA và màu sắc tương ứng với các cụm được gán sau thuật toán Agglomerative Clustering}
        \label{fig:pca-scattering-4-dim-clustering}
    \end{figure}

    Sau khi thực hiện phân cụm, ta vẽ lại scatter-plot như ở hình \ref{fig:pca-scattering-4-dim} giữa đôi một các chiều trong 4 chiều đầu tiên dữ liệu sau khi qua thuật toán PCA nhưng có biểu thị các cụm mà các điểm dữ liệu được gán vào.
    Hình \ref{fig:pca-scattering-4-dim-clustering} biểu thị scatter-plot đã được thêm nhãn cụm là màu sắc tương ứng với cụm mà điểm dữ liệu thuộc về.
    Ta nhận thấy ở cặp chiều thứ 0 và thứ 1, và cặp chiều thứ 1 và thứ 3 đã có sự tách biệt khá rõ ràng giữa các cụm.

    Tiết theo ta sẽ sử dụng các cụm làm các nhãn giả và huấn luyện cho một mô hình phân loại đơn giản.
    Ta sử dụng độ đo là trung bình auc-roc của từng nhãn trên tập test.
    Ta sử dụng đoạn code


    \begin{python}
x_train, x_test, y_train, y_test = train_test_split(reduced_data, y, test_size=0.7, stratify=y, random_state=42)
max_score = 0
max_model = None
max_state = None

for i in tqdm(range(1000)):
    clf = LogisticRegression(solver="newton-cg", multi_class='multinomial')
    clf.fit(x_train, y_train)
    y_pred = clf.predict_proba(x_test)
    #print(y_pred)
    score = roc_auc_score(y_test[:, np.newaxis], y_pred, average="weighted", multi_class="ovr")
    if score > max_score:
        max_score = score
        max_state = i
        max_model = clf
    \end{python}

    Kết quả mô hình cho roc-auc trung bình giữa các nhãn là 0.9883.
    Ta sẽ đưa các tham số của mô hình đặc trưng dựa vào PCA trở về không gian đặc trưng ban đầu của dữ liệu bằng công thức $\bold{W} =   \bold{W}_{PCA} \times \bold{U}^T$.

    Ta sử dụng đoạn code:


    \begin{python}
weights = clf.coef_.dot(pca.components_)
    \end{python}

    Giá trị các trọng số được huấn luyện tương ứng với không gian đặc trưng ban đầu của dữ liệu (có kích thước 4x34) là:

    \begin{verbatim}
  array([[-0.01905233,  0.03040178,  0.07620041,  0.37523721,  0.18468372,
  0.35256868, -1.57644863,  0.0848546 ,  0.22665994, -0.0724047 ,
  0.0510373 ,  0.31990085, -0.09016916, -0.01233888, -0.22776163,
 -0.09697464, -0.25112835, -0.06221071, -0.1389623 ,  0.36737361,
 -0.01134287,  0.13605727,  0.02029419,  0.26085576,  0.09147964,
  0.06936452,  0.30213948,  0.00222139,  0.08332271,  0.05472592,
 -0.26289473,  0.08903341,  0.01931798, -0.01309478],
[ 0.05622108, -0.05680812,  0.39593339,  0.30695345,  0.37188362,
  0.34906731,  1.24639961, -0.05550088, -0.06438522, -0.09470176,
 -0.21854974,  0.0641082 ,  0.22028617,  0.2708387 ,  0.34795807,
  0.47047227,  0.49908779,  0.28891571,  0.39098637,  0.14823743,
  0.53694511, -0.00946755,  0.23426606, -0.06046363,  0.29242132,
  0.23029819, -0.19864076,  0.12716849,  0.06546989,  0.1884355 ,
  0.2398534 , -0.13085081,  0.07781263,  0.02972166],
[-0.03934225,  0.03040776, -0.46143406, -0.77175836, -0.5630687 ,
 -0.68260874,  0.16554538, -0.01007923,  0.0419215 ,  0.23860093,
  0.13918992, -0.11049564, -0.08044431, -0.37659302, -0.10705565,
 -0.12991344, -0.03838426, -0.01329556, -0.03131409, -0.23781619,
 -0.24384137,  0.0449526 , -0.04763537,  0.00774031, -0.17603363,
 -0.10143517,  0.15860663,  0.08869532,  0.02158788, -0.05399911,
  0.25553317,  0.21970301,  0.05670951,  0.22184914],
[ 0.00217349, -0.00400142, -0.01069974,  0.0895677 ,  0.00650136,
 -0.01902724,  0.16450364, -0.01927449, -0.20419622, -0.07149447,
  0.02832253, -0.27351341, -0.0496727 ,  0.11809319, -0.01314079,
 -0.24358419, -0.20957518, -0.21340944, -0.22070998, -0.27779486,
 -0.28176087, -0.17154232, -0.20692488, -0.20813244, -0.20786733,
 -0.19822755, -0.26210535, -0.2180852 , -0.17038048, -0.18916231,
 -0.23249185, -0.1778856 , -0.15384013, -0.23847602]])
    \end{verbatim}

Ta sắp xếp lại các trọng số được huấn luyện theo chiều giảm dần giá trị tuyệt đối của các trọng số tương ứng với từng lớp và chuyển về tên đặc trưng tương ứng dùng đoạn code:

    \begin{python}
sorted_weights = np.argsort(np.abs(weights), axis=1)[:, ::-1]
columns = total_df.columns.tolist()
index_to_column = dict(zip(range(len(columns)), columns))
vectorize = np.vectorize(lambda x: index_to_column[x])
influence_col = vectorize(sorted_weights)
for i, w in enumerate(influence_col.tolist()):
    print("{}: {}".format(i, dict(zip(w, np.round(weights[i][np.argsort(np.abs(weights[i]))[::-1]], 3)))))
    \end{python}

    Đoạn code dưới thể hiện giá trị trọng số tương ứng với từng đặc trưng và từng nhóm sinh viên, vị trí các trọng số được sắp xếp theo chiều giảm dần về giá trị tuyệt đối của các trọng số trong từng lớp.

    \begin{verbatim}
0: {'sex': -1.576, 'freq': 0.375, 'strategy': 0.367, 'educ': 0.353, 'own': 0.32, 'time_2': 0.302,  
'cost': -0.263, 'master': 0.261, 'adv': -0.251, 'grade': -0.228, 'home': 0.227, 
'busy': 0.185,  'sport': -0.139, 'coord': 0.136, 'action': -0.097, 'bored': 0.091, 
'cdrom': -0.09, 'boring': 0.089,  'age': 0.085, 'lonely': 0.083, 'where': 0.076, 
'math': -0.072, 'graphic': 0.069, 'sim': -0.062, 
'rules': 0.055, 'work': 0.051, 'like': 0.03, 'challenge': 0.02, 
'friends': 0.019, 'time_1': -0.019, 'point': -0.013, 'email': -0.012, 
'relax': -0.011, 'frust': 0.002}
1: {'sex': 1.246, 'relax': 0.537, 'adv': 0.499, 'action': 0.47, 
'where': 0.396, 'sport': 0.391, 'busy': 0.372, 'educ': 0.349, 
'grade': 0.348, 'freq': 0.307,  'bored': 0.292, 
'sim': 0.289, 'email': 0.271, 'cost': 0.24, 'challenge': 0.234, 
'graphic': 0.23, 'cdrom': 0.22, 'work': -0.219, 'time_2': -0.199, 
'rules': 0.188, 'strategy': 0.148, 'boring': -0.131, 
'frust': 0.127, 'math': -0.095, 'friends': 0.078, 
'lonely': 0.065, 'home': -0.064, 'own': 0.064, 'master': -0.06, 
'like': -0.057, 'time_1': 0.056, 'age': -0.056, 'point': 0.03, 'coord': -0.009}
2: {'freq': -0.772, 'educ': -0.683, 'busy': -0.563, 'where': -0.461, 
'email': -0.377, 'cost': 0.256,  'relax': -0.244, 'math': 0.239, 
'strategy': -0.238, 'point': 0.222, 'boring': 0.22, 'bored': -0.176, 
'sex': 0.166, 'time_2': 0.159, 'work': 0.139, 'action': -0.13, 
'own': -0.11, 'grade': -0.107,  'graphic': -0.101, 'frust': 0.089, 
'cdrom': -0.08, 'friends': 0.057, 'rules': -0.054, 'challenge': -0.048, 
'coord': 0.045, 'home': 0.042, 'time_1': -0.039, 'adv': -0.038, 
'sport': -0.031, 'like': 0.03, 'lonely': 0.022, 
'sim': -0.013, 'age': -0.01, 'master': 0.008}
3: {'relax': -0.282, 'strategy': -0.278, 'own': -0.274, 'time_2': -0.262, 
'action': -0.244, 'point': -0.238,  'cost': -0.232, 'sport': -0.221, 
'frust': -0.218, 'sim': -0.213, 'adv': -0.21, 'master': -0.208, 'bored': -0.208, 
'challenge': -0.207, 'home': -0.204, 'graphic': -0.198, 'rules': -0.189, 
'boring': -0.178, 'coord': -0.172,  'lonely': -0.17, 'sex': 0.165, 
'friends': -0.154, 'email': 0.118, 'freq': 0.09, 'math': -0.071, 'cdrom': -0.05, 
'work': 0.028, 'age': -0.019, 'educ': -0.019, 'grade': -0.013, 
'where': -0.011, 'busy': 0.007, 'like': -0.004, 'time_1': 0.002}
    \end{verbatim}

    Đối với nhãn giả số 3, đa số là các đặc trưng bên phía dataframe thứ 2 có trọng số lớn nhất.
    Lý do là vì nhãn số 3 tương ứng với các điểm dữ liệu 52,53,54,55 các đặc trưng bên phía dataframe thứ 2 đều cùng giá trị.
    Nhóm số 0 và nhóm số 1 đều có đặc trưng giới tính ảnh hưởng nhiều đến kết quả phân loại.
    Nhóm số 0 có giá trị trọng số được học tương ứng với đặc trưng giới tính là -1.576.
    Ta thấy nhóm này có tỷ lệ nữ cao, do với trọng số trên là nam giới sẽ rất khó được gán vào nhóm này.
    Nhóm số 0 có trọng số được huấn luyện tương ứng với tần suất chơi game là 0.375 cho thấy nhóm này là nhóm là các sinh viên nữ thích chơi game.


    Nhóm số 1 có giá trị trọng số được học tương ứng với đặc trưng giới tính là 1.246.
    Cho ta thấy nhóm này đa số là các sinh viên nam, ngoài ra trong nhóm này sinh viên đa số chơi vì mục đích thư giãn.
    Một số yếu tố nữa, những sinh viên thích chơi game thể loại phiêu lưu và hành động cũng khả năng khá cao vào nhóm này.
    Ngoài ra các yếu tố ảnh hưởng dễ phân loại vào nhóm này gồm nhiều sinh viên thích chơi game thể loại thể thao, dù bận vẫn chơi game.

    Nhóm số 2 có trọng số tương ứng với các đặc trưng freq, educ, busy đều là âm cho thấy nhóm này là những sinh viên gần như rất ít khi chơi game,
    họ cho rằng game ít có tính giáo dục và khi bận gần như chắc chắn không chơi game, nhóm này cho rằng chơi game là lãng phí chi phí và khi stress họ cũng ít chơi game để thư giãn (trọng số relax là -0.244)

    Nhóm số 3 là nhóm các sinh viên thuộc nhóm ngoại lai do không điền bất kỳ thông tin gì ở dataframe thứ 2.

    \textbf{Kết luận:} Ta sẽ phân nhóm sinh viên thành bốn nhóm:
    \begin{itemize}
        \item Nhóm số 0 gồm đa số là các sinh viên nữ có tần suất chơi game cao.
        \item Nhóm số 1 gồm đa số là các sinh viên nam thích chơi game vì mục đích giải trí, nhóm sinh viên thích chơi các thể loại game phiêu lưu, hành động, thể thao và dù có bận vẫn có thể dành thời gian chơi game.
        \item Nhóm số 2 gồm đa số là các sinh viên không thích chơi game vì họ cho rằng game không có tính giáo dục, tốn kém, khi bận gần như chắc chắn họ không chơi game.
        \item Nhóm số 3 gồm 4 điểm ngoại lai do không điền bất kỳ thông tin gì ở dataframe thứ 2.
    \end{itemize}
\end{loigiai}

\newpage
\printbibliography[title={TÀI LIỆU THAM KHẢO}]
\end{document}